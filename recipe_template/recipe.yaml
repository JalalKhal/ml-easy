# `recipe.yaml` is the main configuration file for an MLflow Recipe.
# Required recipe parameters should be defined in this file with either concrete values or
# variables such as {{ INGEST_DATA_LOCATION }}.
#
# Variables must be dereferenced in a profile YAML file, located under `profiles/`.
# See `profiles/local.yaml` for example usage. One may switch among profiles quickly by
# providing a profile name such as `local` in the Recipe object constructor:
# `r = Recipe(profile="local")`
#
# NOTE: All "FIXME::REQUIRED" fields in recipe.yaml and profiles/*.yaml must be set correctly
#       to adapt this template to a specific regression problem. To find all required fields,
#       under the root directory of this recipe, type on a unix-like command line:
#       $> grep "# FIXME::REQUIRED:" recipe.yaml profiles/*.yaml
#
# NOTE: YAML does not support tabs for indentation. Please use spaces and ensure that all YAML
#       files are properly formatted.
  recipe: "classification/v1"

  context:
    recipe_root_path : "/home/khaldi/Documents/github_repos/refined_mlflow/recipe_template"
    target_col: "category"

  # FIXME::REQUIRED: Specifies the target column name for model training and evaluation.

  steps:
    # Specifies the dataset to use for model development
    ingest:
        ingest_fn: "ingest_fn"
        location: "/home/khaldi/Documents/github_repos/refined_mlflow/recipes/test.csv"
        sep: ","
        encoding: "utf-8"
    split:
        split_fn: "split_fn"
        split_ratios: [ 0.75, 0.125, 0.125 ]
    transform:        #
        transformer_fn: "transformer_fn"

    train:
        estimator_fn: "estimator_fn"
        loss: "log_loss"
        validation_metric: &validation_metric
            name: "accuracy_score"
            params: {}
    evaluate:
        validation_criteria:
            - metric: *validation_metric
              threshold: .5
            - metric:
                  name: "f1_score"
                  params: {"average" : "weighted"}
              threshold: .5
    register_:
        register_fn: "register_fn"
        artifact_path: "/model.pkl"
        allow_non_validated_model: false


